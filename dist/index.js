var R=Object.create;var j=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty;var B=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var K=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of A(e))!_.call(t,r)&&r!==n&&j(t,r,{get:()=>e[r],enumerable:!(s=T(e,r))||s.enumerable});return t};var M=(t,e,n)=>(n=t!=null?R(C(t)):{},K(e||!t||!t.__esModule?j(n,"default",{value:t,enumerable:!0}):n,t));var S=B((Y,O)=>{O.exports=d;d.flatten=d;d.unflatten=$;function w(t){return t&&t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function x(t){return t}function d(t,e){e=e||{};let n=e.delimiter||".",s=e.maxDepth,r=e.transformKey||x,i={};function l(g,m,p){p=p||1,Object.keys(g).forEach(function(a){let o=g[a],u=e.safe&&Array.isArray(o),c=Object.prototype.toString.call(o),f=w(o),h=c==="[object Object]"||c==="[object Array]",y=m?m+n+r(a):r(a);if(!u&&!f&&h&&Object.keys(o).length&&(!e.maxDepth||p<s))return l(o,y,p+1);i[y]=o})}return l(t),i}function $(t,e){e=e||{};let n=e.delimiter||".",s=e.overwrite||!1,r=e.transformKey||x,i={};if(w(t)||Object.prototype.toString.call(t)!=="[object Object]")return t;function g(a){let o=Number(a);return isNaN(o)||a.indexOf(".")!==-1||e.object?a:o}function m(a,o,u){return Object.keys(u).reduce(function(c,f){return c[a+n+f]=u[f],c},o)}function p(a){let o=Object.prototype.toString.call(a),u=o==="[object Array]",c=o==="[object Object]";if(a){if(u)return!a.length;if(c)return!Object.keys(a).length}else return!0}return t=Object.keys(t).reduce(function(a,o){let u=Object.prototype.toString.call(t[o]);return!(u==="[object Object]"||u==="[object Array]")||p(t[o])?(a[o]=t[o],a):m(o,a,d(t[o],e))},{}),Object.keys(t).forEach(function(a){let o=a.split(n).map(r),u=g(o.shift()),c=g(o[0]),f=i;for(;c!==void 0;){if(u==="__proto__")return;let h=Object.prototype.toString.call(f[u]),y=h==="[object Object]"||h==="[object Array]";if(!s&&!y&&typeof f[u]<"u")return;(s&&!y||!s&&f[u]==null)&&(f[u]=typeof c=="number"&&!e.object?[]:{}),f=f[u],o.length>0&&(u=g(o.shift()),c=g(o[0]))}f[u]=$(t[a],e)}),i}});function b(t){return e=>n=>t({settings:e,env:n})}var I=M(S(),1);var E=N;function N(t,e,n){var s,r;if(Array.isArray(e)&&(s=e.slice(0)),typeof e=="string"&&(s=e.split(".")),typeof e=="symbol"&&(s=[e]),!Array.isArray(s))throw new Error("props arg must be an array, a string or a symbol");if(r=s.pop(),!r)return!1;P(r);for(var i;i=s.shift();)if(P(i),typeof t[i]>"u"&&(t[i]={}),t=t[i],!t||typeof t!="object")return!1;return t[r]=n,!0}function P(t){if(t=="__proto__"||t=="constructor"||t=="prototype")throw new Error("setting of prototype values not supported")}var J=b(({settings:t,env:e})=>({id:"samuelstroschein.inlangPluginJson",async config(){return{languages:await L({$fs:e.$fs,settings:t}),readResources:async n=>k({...n,$fs:e.$fs,settings:t}),writeResources:async n=>v({...n,$fs:e.$fs,settings:t})}}}));async function L(t){let[e,n]=t.settings.pathPattern.split("{language}"),s=await t.$fs.readdir(e),r=[];for(let i of s)typeof i=="string"&&i.endsWith(".json")&&r.push(i.replace(".json",""));return r}async function k(t){let e=[];for(let n of t.config.languages){let s=t.settings.pathPattern.replace("{language}",n),r=JSON.parse(await t.$fs.readFile(s,{encoding:"utf-8"})),i=(0,I.default)(r);e.push(z(i,n,t.settings.variableReferencePattern))}return e}async function v(t){for(let e of t.resources){let n=t.settings.pathPattern.replace("{language}",e.languageTag.name);await t.$fs.writeFile(n,D(e,t.settings.variableReferencePattern))}}function z(t,e,n){return{type:"Resource",languageTag:{type:"LanguageTag",name:e},body:Object.entries(t).map(([s,r])=>F(s,r,n))}}function F(t,e,n){let s=n&&(n[1]?new RegExp(`(\\${n[0]}[^\\${n[1]}]+\\${n[1]})`,"g"):new RegExp(`(${n}\\w+)`,"g")),r=[];if(s){let i=e.split(s);for(let l=0;l<i.length;l++)s.test(i[l])?r.push({type:"Placeholder",body:{type:"VariableReference",name:n[1]?i[l].slice(n[0].length,n[1].length*-1):i[l].slice(n[0].length)}}):r.push({type:"Text",value:i[l]})}else r.push({type:"Text",value:e});return{type:"Message",id:{type:"Identifier",name:t},pattern:{type:"Pattern",elements:r}}}function D(t,e){let n={};return t.body.forEach(s=>{let[r,i]=V(s,e);E(n,r,i)}),JSON.stringify(n,null,2)}function V(t,e){let n=[];for(let r of t.pattern.elements)r.type==="Text"||!e?n.push(r.value):r.type==="Placeholder"&&(e[1]?n.push(`${e[0]}${r.body.name}${e[1]}`):n.push(`${e[0]}${r.body.name}`));let s=n.join("");return[t.id.name,s]}export{J as default};
/*! Bundled license information:

@inlang/core/dist/plugin/pluginBuildConfig.js:
  (*! DON'T TOP-LEVEL IMPORT ESBUILD PLUGINS. USE DYNAMIC IMPORTS. *)
  (*! See https://github.com/inlang/inlang/issues/486 *)
*/
